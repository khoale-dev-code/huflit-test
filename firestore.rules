rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // ============================================
    // PUBLIC DATA - Everyone can read
    // ============================================
    
    // Exam Data - public read
    match /examData/{document=**} {
      allow read: if true;
      allow write: if false;
    }
    
    // Vocabulary Data - public read
    match /vocabularyData/{document=**} {
      allow read: if true;
      allow write: if false;
    }
    
    // Grammar Data - public read
    match /grammarData/{document=**} {
      allow read: if true;
      allow write: if false;
    }
    
    // Metadata - public read
    match /metadata/{document=**} {
      allow read: if true;
      allow write: if false;
    }
    
    // ============================================
    // PRIVATE DATA - User Progress
    // ============================================
    
    // Users collection (Clerk webhook creates these)
    match /users/{userId} {
      allow read: if true;  // Allow read for now
      allow write: if false; // Only webhook can write
    }
    
    // User Progress - OPEN FOR DEVELOPMENT
    // TODO: Add proper security after Clerk-Firebase integration
    match /userProgress/{docId} {
      // TEMPORARY: Allow all authenticated reads/writes
      allow read, write, create, update, delete: if true;
    }
    
    // ============================================
    // FALLBACK - Deny everything else
    // ============================================
    match /{document=**} {
      allow read, write: if false;
    }
  }
}